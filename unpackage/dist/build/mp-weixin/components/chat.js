(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/chat"],{6644:function(t,i,e){"use strict";var n=e("9ee8"),o=e.n(n);o.a},7749:function(t,i,e){"use strict";e.d(i,"b",(function(){return o})),e.d(i,"c",(function(){return r})),e.d(i,"a",(function(){return n}));var n={markdownRender:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/markdown-render/components/markdown-render/markdown-render")]).then(e.bind(null,"27ad"))}},o=function(){var t=this,i=t.$createElement,e=(t._self._c,t.__map(t.historyList,(function(i,e){var n=t.__get_orig(i),o="voice"==i.msg_type?Math.ceil(20*i.voice.second):null,r="voice"==i.msg_type?Math.ceil(i.voice.second):null;return{$orig:n,g0:o,g1:r}}))),n=t.historyList.length,o=t.qaList.length,r=0!=o?t.__map(t.qaList,(function(i,e){var n=t.__get_orig(i),o="text"==i.msg_type&&"customer"!=i.origin?e==t.qaList.length-1&&t.answerContinue:null,r="voice"==i.msg_type?Math.ceil(20*i.voice.second):null,s="voice"==i.msg_type?Math.ceil(i.voice.second):null,c=i.may_ask?i.may_ask.length>0&&e==t.qaList.length-1&&!t.answerContinue&&"customer"!=i.origin:null,a=t.qaList.length,l=t.qaList.length,u=t.qaList.length;return{$orig:n,g4:o,g5:r,g6:s,g7:c,g8:a,g9:l,g10:u}})):null;t._isMounted||(t.e0=function(i,e){var n=arguments[arguments.length-1].currentTarget.dataset,o=n.eventParams||n["event-params"];e=o.askItem;return i.stopPropagation(),function(){return t.sendMsg(e,"tip")}()}),t.$mp.data=Object.assign({},{$root:{l0:e,g2:n,g3:o,l1:r}})},r=[]},"905f":function(t,i,e){"use strict";e.r(i);var n=e("a459"),o=e.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(r);i["default"]=o.a},"9ee8":function(t,i,e){},a459:function(t,i,e){"use strict";(function(t,n){var o=e("47a9");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=o(e("7eb4")),s=o(e("ee10")),c=o(e("7ca3")),a=e("8f59");function l(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,n)}return e}var u=getApp(),h={name:"welcome",props:["top","bottom","historyList","qaList","scrollHeight","answering","greetingObj","answerContinue","scrollStr"],data:function(){return{imgUrl:u.globalData.baseImageUrl,tipList:[{text:"我想找个长白班的工作。"},{text:"请问哪些工作是提供吃住的？"},{text:"有没有适合我的工作，轻松一点的。"}],historyId:0,loadAllHistory:!1,scrollView:"fenge_line",Audio:u.globalData.Audio,currentPlayType:"",currentPlayIndex:0,currentContHeight:0,freshing:!1,trigger:!1,cardDoubleClick:!1,showHand:!0,scrollRemainHis:""}},computed:function(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?l(Object(e),!0).forEach((function(i){(0,c.default)(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}({},(0,a.mapState)(["showInterviewCard","inChannel","channelId","showChannelInterviewCard","sureJobName","sureJobId"])),components:{cardKefu:function(){e.e("components/chat_card_kefu").then(function(){return resolve(e("9ccb"))}.bind(null,e)).catch(e.oe)},cardRecharge:function(){e.e("components/chat_card_recharge").then(function(){return resolve(e("0fb7"))}.bind(null,e)).catch(e.oe)},cardSignupe:function(){e.e("components/chat_card_signup").then(function(){return resolve(e("de74"))}.bind(null,e)).catch(e.oe)}},created:function(){var t=this;return(0,s.default)(r.default.mark((function i(){return r.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.Audio.onStop((function(i){t.closeAnmition()})),t.Audio.onEnded((function(i){t.closeAnmition()}));case 2:case"end":return i.stop()}}),i)})))()},watch:{qaList:{handler:function(t,i){console.log("chat 监听qaList：",t);this.showHand=!0,this.getElementHeight()},deep:!0},currentContHeight:function(t){var i=this;console.log("currentContHeight改变了"),this.answerContinue&&setTimeout((function(){i.toScroll()}),1e3)},scrollHeight:function(t){console.log("新窗口高度：",t),this.toScroll()},answerContinue:function(t){console.log("answerContinue改变了"),t||this.toScroll()},answering:function(t){console.log("answering改变了"),t&&this.toScroll()},scrollStr:function(t){console.log("scrollStr改变了");var i=this;i.scrollView="",this.$nextTick((function(){i.scrollView=t}))}},methods:{getElementHeight:function(){var i=this,e=t.createSelectorQuery().in(this),n="#cont"+(this.qaList.length-1);e.select(n).boundingClientRect((function(t){t&&(i.currentContHeight=t.height)})).exec()},setScrollHeight:function(){this.$emit("setScrollHeight")},closeHand:function(){this.showHand=!1},refreshRestore:function(){this.freshing=!1,this.trigger=!1,console.log("freshing/trigger：",this.freshing,this.trigger)},getMoreHistory:function(){this.scrollRemainHis="his"+this.historyList[0].id,this.freshing||(this.freshing=!0,this.trigger=!0,this.$emit("moreHis"))},clickSureCard:function(i){var e=this,n=this;if(this.cardDoubleClick)t.showToast({title:"请勿连续点击",icon:"error",duration:2e3});else{this.cardDoubleClick=!0,setTimeout((function(){n.cardDoubleClick=!1}),2e3);var o="/api/chat/job/"+i.card.job_id+"/is-interviewed";this.$aiRequest(o).then((function(n){if(0==n.code)if(n.data.is_interviewed)t.showToast({title:"该职位您已面试",icon:"error",duration:2e3});else{var o={type:"interview",job_id:i.card.job_id};e.$emit("tocall",o)}}))}},sendMsg:function(t,i){var e={msg:t,type:i};console.log("chat obj",e),this.$emit("sendMsg",e)},handleAudio:function(t,i,e){this.currentPlayType=t,this.currentPlayIndex=e,this.Audio.paused?this.playAudio(i):this.stopAudio(i)},playAudio:function(t){var i=this;this.Audio.src=t.voice.media.url,this.Audio.id=t.id,this.Audio.play(),"his"==this.currentPlayType?(this.historyList.forEach((function(t,e){"voice"==t.msg_type&&(e==i.currentPlayIndex?i.historyList[i.currentPlayIndex].voice.anmitionPlay=!0:i.historyList[e].voice.anmitionPlay=!1)})),this.qaList.forEach((function(t,e){"voice"==t.msg_type&&(i.qaList[e].voice.anmitionPlay=!1)}))):(this.qaList.forEach((function(t,e){"voice"==t.msg_type&&(e==i.currentPlayIndex?i.qaList[i.currentPlayIndex].voice.anmitionPlay=!0:i.qaList[e].voice.anmitionPlay=!1)})),this.historyList.forEach((function(t,e){"voice"==t.msg_type&&(i.historyList[e].voice.anmitionPlay=!1)})))},stopAudio:function(t){var i=this;"his"==this.currentPlayType?(this.historyList[this.currentPlayIndex].voice.anmitionPlay=!1,this.qaList.forEach((function(t,e){"voice"==t.msg_type&&(i.qaList[e].voice.anmitionPlay=!1)}))):(this.qaList[this.currentPlayIndex].voice.anmitionPlay=!1,this.historyList.forEach((function(t,e){"voice"==t.msg_type&&(i.historyList[e].voice.anmitionPlay=!1)}))),this.Audio.src="",this.Audio.stop()},stopCurAudio:function(){this.Audio.src="",this.Audio.stop()},closeAnmition:function(){var t=this,i=this.Audio.id;"his"==this.currentPlayType?this.historyList.forEach((function(e,n){"voice"==e.msg_type&&e.id==i&&(t.historyList[n].voice.anmitionPlay=!1)})):this.qaList.forEach((function(e,n){"voice"==e.msg_type&&e.id==i&&(t.qaList[n].voice.anmitionPlay=!1)})),this.currentPlayType="",this.currentPlayIndex=0},formatResultStr:function(t){t&&this.speeking(t)},toCall:function(){var i=this;if(this.cardDoubleClick)t.showToast({title:"请勿连续点击",icon:"error",duration:2e3});else{this.cardDoubleClick=!0,setTimeout((function(){i.cardDoubleClick=!1}),2e3);var e={type:"interview",job_id:this.sureJobId};this.$emit("tocall",e)}},speeking:function(t){console.log(t,"播报内容"),plugin.textToSpeech({lang:"zh_CN",content:t,success:function(t){0==t.retcode?(console.log("result",t.result),n.playBackgroundAudio({dataUrl:t.filename,title:""})):console.warn("翻译失败",t)},fail:function(t){console.log("网络失败",t)}})},showTrans:function(t,i){t.showTranlate||("his"==i?this.historyList.forEach((function(i,e){i.id==t.id&&(i.showTranIcon=!0)})):this.qaList.forEach((function(i,e){i.id==t.id&&(i.showTranIcon=!0)})))},startTrans:function(i,e){var n=this;if(i.showTranIcon=!1,"his"==e)this.historyList.forEach((function(t,e){t.id==i.id&&(t.showTranlate=!0)}));else if(!i.showTranlate){n.qaList.forEach((function(t,e){t.id==i.id&&(t.showTransing=!0)}));var o="/api/chat/voice/"+i.id+"/recognize/result",r=setInterval((function(){n.$aiRequest(o).then((function(e){console.log(e,"查询结果"),0==e.code?e.data.content&&(i.content=e.data.content,n.qaList.forEach((function(t,e){t.id==i.id&&(t.showTranlate=!0,t.showTransing=!1)})),clearInterval(r)):(clearInterval(r),t.hideLoading())}))}),1e3)}},scrollToPre:function(){var t=this;t.scrollView="",this.$nextTick((function(){t.scrollView=t.scrollRemainHis}))},toScroll:function(){var i=this,e=this;e.scrollView="",this.$nextTick((function(){i.answering?(console.log("正在回答"),e.scrollView="answering"):0==e.qaList.length?e.scrollView="fenge_line":(e.scrollView="continue",t.hideLoading())}))}}};i.default=h}).call(this,e("df3c")["default"],e("3223")["default"])},b8f1:function(t,i,e){"use strict";e.r(i);var n=e("7749"),o=e("905f");for(var r in o)["default"].indexOf(r)<0&&function(t){e.d(i,t,(function(){return o[t]}))}(r);e("6644");var s=e("828b"),c=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);i["default"]=c.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/chat-create-component',
    {
        'components/chat-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('df3c')['createComponent'](__webpack_require__("b8f1"))
        })
    },
    [['components/chat-create-component']]
]);
