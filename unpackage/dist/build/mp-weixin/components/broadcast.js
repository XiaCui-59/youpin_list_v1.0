(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/broadcast"],{"2cdc":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,a=(t._self._c,t.period.filter((function(e){return e.value==t.currentPlay.worker_salary_type}))),n=a[0]?t.period.filter((function(e){return e.value==t.currentPlay.worker_salary_type})):null;t.$mp.data=Object.assign({},{$root:{g0:a,g1:n}})},i=[]},7116:function(t,e,a){},7528:function(t,e,a){"use strict";a.r(e);var n=a("c605"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},bfca:function(t,e,a){"use strict";var n=a("7116"),i=a.n(n);i.a},c605:function(t,e,a){"use strict";(function(t){var n=a("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("7eb4")),o=n(a("ee10")),r=n(a("7ca3")),c=n(a("5645")),s=a("8f59");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){(0,r.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d=getApp(),h={name:"broadcast",props:["top","bottom","canPlay","showUserStep"],data:function(){return{visible:!1,showSureJob:!1,showNext:!1,scrollTop:0,period:c.default.periodList,current:0,dots:2,imgUrl:d.globalData.baseImageUrl,recommendList:[],currentPlay:{project_id:"",content:"",may_ask:[],project_name:"",voice:"",worker_salary_max:"",worker_salary_min:"",worker_salary_type:""},currentPlayIndex:0,muted:!1,systemHeight:d.globalData.systemHeight,animationActive:!0,animationTimer:null,welcomeVoiceList:[d.globalData.baseImageUrl+"/worker/wel01.mp3",d.globalData.baseImageUrl+"/worker/wel02.mp3",d.globalData.baseImageUrl+"/worker/wel03.mp3"],lastClickTime:0,requestTimer:null,reConnectCount:0,mayAskCount:0,bannerImageInfo:null,bannerHeight:0,currentStep:1,firstEnd:!1,isWelcome:!0,clickProject:{project_id:"",content:"",may_ask:[],project_name:"",voice:"",worker_salary_max:"",worker_salary_min:"",worker_salary_type:""}}},computed:u({},(0,s.mapState)(["city","aiReady"])),created:function(){var t=this,e=this;setTimeout((function(){e.visible=!0}),100),this.getRecommend(),d.globalData.Audio.onPlay((function(e){t.isWelcome||t.textAnimation()})),d.globalData.Audio.onStop((function(t){})),d.globalData.Audio.onEnded((function(e){t.canPlay&&(t.firstEnd?t.playNext():t.playFirst())}))},watch:{animationActive:function(t){t||this.stopInterval()},canPlay:function(t){console.log("canPlay:",t),t?this.stopInterval():(d.globalData.Audio.pause(),this.muted=!0)},currentPlayIndex:function(t){this.getMayAsk()}},beforeDestroy:function(){d.globalData.Audio.pause(),this.muted=!0},methods:{close:function(){var t=this;this.visible=!1,setTimeout((function(){t.$emit("close")}),800)},toInvite:function(){t.navigateTo({url:"/pages/invite/invite"})},toChat:function(t){this.clickProject=u({},this.currentPlay);var e="surejob"==t?"text_want_application":"findjob"==t?"text_look_for_job":"text_interview",a="surejob"==t?this.clickProject.project_id:"",n="surejob"==t?"我对"+this.clickProject.project_name+"（职位ID："+this.clickProject.project_id+"）很感兴趣，能为我介绍一下吗？":"findjob"==t?"我正在找工作，能帮我推荐一些合适的职位吗？":"我可以开始面试了，什么时候安排？",i={msg:n,type:t,job_id:a,action:e,name:this.clickProject.project_name?this.clickProject.project_name:""};this.close(),this.$emit("sendMsg",i)},toCall:function(t){var e={type:t,job_id:"surejob"==t?this.currentPlay.project_id:""};this.$emit("tocall",e)},nextStep:function(){this.currentStep<6?this.currentStep++:(t.setStorageSync("readsteps",1),this.canPlay&&this.playWelcome(),this.$emit("closeStep"))},changeNext:function(){this.showNext=!1;var t=this.recommendList.length;if(this.currentPlayIndex==t-1){this.close(),this.$emit("sendMsg",{msg:"我正在找工作，能帮我推荐一些合适的职位吗？",type:"",job_id:""})}else d.globalData.Audio.stop(),this.playNext()},playFirst:function(){this.firstEnd=!0,this.isWelcome=!1,this.canPlay&&!this.muted&&this.playAudio()},playNext:function(){var t=this,e=this.recommendList.length;this.currentPlayIndex<e-1?(this.currentPlayIndex++,this.currentPlay=this.recommendList[this.currentPlayIndex]):(this.currentPlayIndex=0,this.currentPlay=this.recommendList[this.currentPlayIndex],this.currentPlayIndex++),setTimeout((function(){t.canPlay&&!t.muted&&t.playAudio()}),50)},stopInterval:function(){this.animationTimer&&(clearInterval(this.animationTimer),this.animationTimer=null,this.scrollTop=0)},handleAudio:function(){this.$emit("openCanPlay"),d.globalData.Audio.paused?this.playAudio():this.pauseAudio()},playAudio:function(){this.canPlay&&(d.globalData.Audio.src=this.currentPlay.voice,d.globalData.Audio.play(),this.muted=!1)},playWelcome:function(){var t=Math.floor(Math.random()*this.welcomeVoiceList.length);d.globalData.Audio.src=this.welcomeVoiceList[t],d.globalData.Audio.play(),this.muted=!1},stopAudio:function(){d.globalData.Audio.src="",d.globalData.Audio.stop()},pauseAudio:function(){d.globalData.Audio.pause(),this.muted=!0},getMayAsk:function(){var t=this;return(0,o.default)(i.default.mark((function e(){var a,n;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="/homepage/may_ask/"+t.currentPlay.project_id,e.prev=1,e.next=4,t.$request(a);case 4:n=e.sent,t.currentPlay.may_ask=n.data.list.may_ask,t.showNext=!0,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),t.mayAskCount<5?(t.getMayAsk(),t.mayAskCount++):t.mayAskCount=0;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},getRecommend:function(){var e=this;return(0,o.default)(i.default.mark((function a(){var n,o,r;return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e,o={city:e.city},a.prev=2,a.next=5,e.$request("/homepage",o,"POST");case 5:r=a.sent,e.$emit("setGreetStatus"),r.data.list.length>0?(e.currentPlay=r.data.list[0],e.recommendList=r.data.list,e.showSureJob=!0,e.getMayAsk(),!e.showUserStep&&e.canPlay&&e.playWelcome()):e.$refs.myModal.showModal({title:"暂无推荐职位信息",showCancel:!1}),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),console.error("An error occurred:",a.t0),n.reConnectCount<10?(n.reConnectCount++,n.getRecommend()):t.showModal({title:"网络超时，请重新进入小程序。",showCancel:!1,success:function(e){e.confirm&&(n.reConnectCount=0,t.reLaunch({url:"/subpkg/index/index"}))}});case 14:case"end":return a.stop()}}),a,null,[[2,10]])})))()},sendMsg:function(t,e){this.clickProject=u({},this.currentPlay);var a={msg:this.clickProject.project_name+"（职位id："+this.clickProject.project_id+"）"+t,type:e,job_id:this.clickProject.project_id,name:this.clickProject.project_name};this.close(),this.$emit("sendMsg",a)},textAnimation:function(){var t=this;t.scrollTop=0,this.animationTimer||(this.animationTimer=setInterval((function(){t.scrollTop+=2}),300))},touchStart:function(){this.animationActive=!1},scrollLower:function(){this.animationActive&&(this.scrollTop=0)}}};e.default=h}).call(this,a("df3c")["default"])},cb87:function(t,e,a){"use strict";a.r(e);var n=a("2cdc"),i=a("7528");for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("bfca");var r=a("828b"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"be63ab8c",null,!1,n["a"],void 0);e["default"]=c.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/broadcast-create-component',
    {
        'components/broadcast-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('df3c')['createComponent'](__webpack_require__("cb87"))
        })
    },
    [['components/broadcast-create-component']]
]);
