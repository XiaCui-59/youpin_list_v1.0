(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/bank_card/bank_card"],{1311:function(e,n,t){},1452:function(e,n,t){"use strict";var a=t("1311"),o=t.n(a);o.a},3909:function(e,n,t){"use strict";(function(e,n){var a=t("47a9");t("e32d");a(t("3240"));var o=a(t("5980"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(o.default)}).call(this,t("a261")["default"],t("a261")["createPage"])},"408d":function(e,n,t){"use strict";(function(e){var a=t("47a9");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=a(t("7eb4")),r=a(t("ee10")),i=getApp(),c={data:function(){return{imgUrl:i.globalData.baseImageUrl,pageName:"添加银行卡",marginTop:0,scrollHeight:0,boxTop:0,headerHeight:0,hasBank:!1,showModify:!1,bank_name:"",bank_num:"",name:"",info:{account_holder_name:"",bank_card_front_image:"",bank_card_number:"",bank_name:""},bankCard:{key:"",url:""}}},components:{customHeader:function(){t.e("components/custom_header").then(function(){return resolve(t("8f8a"))}.bind(null,t)).catch(t.oe)}},onLoad:function(){var n=this,t=this;this.getMarginTop(),setTimeout((function(){t.getElementInfo(),t.getTopHeight()}),500),this.$request("/worker/have/bank").then((function(e){0==e.code&&(e.data?(n.hasBank=!0,n.pageName="银行卡信息",n.getInfo()):(n.pageName="添加银行卡",n.hasBank=!1))})),this.name=e.getStorageSync("userInfo").name},methods:{getMarginTop:function(n){var t=e.getMenuButtonBoundingClientRect();this.marginTop=t.height+t.top+10},getTopHeight:function(){var n=e.getSystemInfoSync();this.headerHeight=Math.floor(n.screenHeight*(200/844))},getElementInfo:function(){var n=this,t=e.getSystemInfoSync(),a=e.createSelectorQuery().select(".top_area");a.boundingClientRect((function(e){e&&(e.height,n.boxTop=n.marginTop+e.height),n.scrollHeight=t.screenHeight-n.boxTop-5})).exec()},prevImage:function(n){var t=[];t[0]=n,e.previewImage({urls:t,current:0})},toModify:function(){this.showModify=!0},cancel:function(){this.showModify=!1},chooseImage:function(n){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var a=e.tempFilePaths;t.loadimg(n,a[0])},fail:function(e){console.log(e)}})},loadimg:function(n,t){var a=this;return(0,r.default)(o.default.mark((function r(){var c,u;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return c=a,u={Authorization:"bearer "+e.getStorageSync("token"),accept:"application/json","content-type":"multipart/form-data"},o.abrupt("return",new Promise((function(a,o){e.uploadFile({url:i.globalData.baseUrl+"/worker/upload/image?type="+n,filePath:t,name:"file",header:u,success:function(n){var t=JSON.parse(n.data);0==t.code?(e.showToast({title:"图片上传成功"}),c.bankCard=t.data,c.$request("/worker/ocr/bank-card",{key:t.data.key},"POST").then((function(e){0==e.code&&(c.bank_name=e.data.bank_name,c.bank_num=e.data.card_number)}))):e.showModal({title:"上传失败",content:t.msg})},complete:function(){e.hideLoading()}}),a(c.reponsefiles)})));case 3:case"end":return o.stop()}}),r)})))()},getInfo:function(){var e=this;this.$request("/worker/bank-account").then((function(n){0==n.code&&(e.info=n.data)}))},confirm:function(){var n=this,t={bank_name:this.bank_name,bank_card_number:this.bank_num,account_holder_name:this.name,bank_card_front_image:this.bankCard.key};this.$request("/worker/bank-account",t,"POST").then((function(t){0==t.code&&(e.showToast({title:"保存成功",duration:2e3}),n.hasBank=!0,n.showModify=!1,n.getInfo())}))}}};n.default=c}).call(this,t("a261")["default"])},5980:function(e,n,t){"use strict";t.r(n);var a=t("bedb"),o=t("ab4d");for(var r in o)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(r);t("1452");var i=t("828b"),c=Object(i["a"])(o["default"],a["b"],a["c"],!1,null,"414ccb70",null,!1,a["a"],void 0);n["default"]=c.exports},ab4d:function(e,n,t){"use strict";t.r(n);var a=t("408d"),o=t.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return a[e]}))}(r);n["default"]=o.a},bedb:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){}));var a=function(){var e=this.$createElement;this._self._c},o=[]}},[["3909","common/runtime","common/vendor"]]]);